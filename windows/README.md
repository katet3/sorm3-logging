Чтобы данный скрипт выполнялся при входе пользователя в систему в Active Directory, можно использовать групповую политику (Group Policy) для запуска PowerShell скрипта при входе пользователя. Вот шаги, которые вам нужно выполнить:

    Создайте и сохраните PowerShell скрипт:
    Сохраните ваш скрипт в виде .ps1 файла, например UserLoginLog.ps1.

    Создайте общий доступ к файлу:
    Сохраните этот файл на общедоступном сетевом ресурсе, к которому могут получить доступ все пользователи домена.

    Создайте групповую политику:
    Откройте Group Policy Management Console (GPMC) на контроллере домена и выполните следующие шаги:

        Перейдите к разделу, где вы хотите создать новую политику или отредактировать существующую (например, User Configuration или Computer Configuration в зависимости от ваших требований).

        Щелкните правой кнопкой мыши и выберите "Создать политику GPO в этом домене и ссылать его здесь".

        Назовите новую политику (например, "User Login Script Policy").

    Настройте запуск скрипта при входе пользователя:

        Щелкните правой кнопкой мыши на созданной политике и выберите "Изменить".

        Перейдите к User Configuration -> Policies -> Windows Settings -> Scripts (Logon/Logoff).

        Дважды щелкните Logon.

        Нажмите "Добавить", затем "Обзор" и укажите путь к вашему скрипту (например, \\server\share\UserLoginLog.ps1).

    Примените политику к пользователям:
    Свяжите созданную политику с организационной единицей (OU), содержащей учетные записи пользователей, к которым вы хотите применить эту политику.

    Обновите политики на клиентских компьютерах:
    Политики должны автоматически обновиться на клиентских компьютерах в течение нескольких часов. Чтобы немедленно применить изменения, выполните на клиентском компьютере команду:

    shell

    gpupdate /force
